import{j as t,S as i,a as y,ac as U,_ as A,r as m,T as u,s as S,a4 as g,B as C,ad as Y,ae as L,af as T,ag as N,A as w,a5 as V}from"./vendor-BcDla1Uu.js";import{F as O}from"./page-private-DAWryy5m.js";import{u as z,P as M,a as G,b as W}from"./layout-layout-root-D2OMHT6m.js";function Q(){return t.jsx(i,{sx:{default:{alignItems:"center",justifyContent:"center",flexGrow:1,padding:"12px",overflow:"hidden"}}})}function X(){const{t:h}=y("translation",{keyPrefix:"form"}),{t:c}=y("translation",{keyPrefix:"public.sign-in"}),{validationSignIn:o,validationFunctions:d,getError:r}=z(),{mutateAsync:p}=U(),n=A({defaultValues:{username:"",password:""},onSubmit:async({value:a})=>{try{await p({body:{password:a.password,nickname:a.username}})}catch{}},canSubmitWhenInvalid:!1,validators:{onChangeAsync:d.change(o),onBlurAsync:d.blur(o)}});return m.useEffect(()=>{n.validate("blur")},[n,h]),t.jsxs(t.Fragment,{children:[t.jsxs(i,{sx:{default:{flexDirection:"column",gap:"10px",alignItems:"stretch",userSelect:"none"}},children:[t.jsx(u,{sx:{default:{variant:"h2",weight:700,color:"black100"}},children:c("title-welcome")}),t.jsxs(u,{sx:{default:{variant:"h8",weight:400,color:"black100"}},children:[c("title-sign-up-1")," ",t.jsx(S,{to:M.fullPath,sx:{default:{variant:"h8",weight:400,color:"blueRest",cursor:"pointer"}},children:c("title-sign-up-2")})]})]}),t.jsxs(O,{handleSubmit:n.handleSubmit,sx:{default:{width:"100%",gap:"25px"}},children:[t.jsx(n.Field,{name:"username",children:a=>t.jsx(i,{sx:{default:{flexDirection:"column",gap:"6px",position:"relative"}},children:t.jsx(g,{variety:"standard",autoComplete:"username",placeholder:h("username.placeholder"),id:a.name,name:a.name,value:a.state.value,onBlur:a.handleBlur,onChange:a.handleChange,genre:"grayBorder",size:"medium",isNoSpaces:!0,error:r(a.state.meta)})})}),t.jsx(n.Field,{name:"password",children:a=>t.jsx(i,{sx:{default:{flexDirection:"column",gap:"6px",position:"relative"}},children:t.jsx(g,{variety:"standard",autoComplete:"current-password",type:"password",placeholder:h("password.placeholder"),id:a.name,name:a.name,value:a.state.value,onBlur:a.handleBlur,onChange:a.handleChange,genre:"grayBorder",size:"medium",isNoSpaces:!0,error:r(a.state.meta)})})}),t.jsx(i,{sx:{default:{flexDirection:"row",justifyContent:"flex-end",alignItems:"center"}},children:t.jsx(S,{to:G.fullPath,sx:{default:{variant:"h8",weight:400,color:"blueRest",cursor:"pointer"}},children:c("title-forgot-password")})}),t.jsx(n.Subscribe,{children:a=>t.jsx(C,{type:"submit",isHidden:!a.canSubmit,isDisabled:!a.canSubmit||a.isSubmitting,genre:"product",size:"medium",isOnlyIcon:a.isSubmitting,icons:[{type:"loading",name:"Line",isHidden:!a.isSubmitting}],children:c("title-button")})})]})]})}function Z(){const{validationSignUp:h,validationFunctions:c,getError:o}=z(),{t:d}=y("translation",{keyPrefix:"form"}),{t:r}=y("translation",{keyPrefix:"public.sign-up"}),{t:p}=y("translation",{keyPrefix:"date"}),[n,a]=m.useState(0),[B,x]=m.useState(!1),[P,b]=m.useState(0),{mutateAsync:E,reset:k}=Y(),{mutateAsync:j,isPending:D,reset:F}=L(),{mutateAsync:R,reset:I}=T(),s=A({defaultValues:{email:"",currentPassword:"",confirmPassword:"",username:"",dateOfBirth:null,code:""},onSubmit:async({value:e})=>{if(n===0)try{await j({path:{email:e.email}})}catch{v()}finally{a(l=>l+1),x(!0),b(60);const f=setInterval(()=>{b(l=>l<=1?(clearInterval(f),x(!1),0):l-1)},1e3)}else try{await E({body:{code:e.code,email:e.email}});try{await R({body:{password:e.currentPassword,email:e.email,nickname:e.username,dateOfBirth:w(e.dateOfBirth).format("DD.MM.YYYY")}})}catch{v()}}catch{if(n>=3){v();return}}},validators:{onBlurAsync:c.blur(h),onChangeAsync:c.change(h)}});m.useEffect(()=>{s.validate("blur")},[s,r]);const v=m.useCallback(()=>{k(),F(),I(),s.reset(),a(0),x(!1),b(0)},[s,F,k,I]),H=m.useCallback(async e=>{try{await j({path:{email:e}})}catch{}finally{a(l=>l+1),x(!0),b(60);const f=setInterval(()=>{b(l=>l<=1?(clearInterval(f),x(!1),0):l-1)},1e3)}},[j]);return t.jsxs(t.Fragment,{children:[t.jsx(i,{sx:{default:{flexDirection:"column",gap:"10px",alignItems:"stretch",userSelect:"none"}},children:n===0?t.jsxs(t.Fragment,{children:[t.jsx(u,{sx:{default:{variant:"h2",weight:700,color:"black100"}},children:r("title")}),t.jsxs(u,{sx:{default:{variant:"h8",weight:400,color:"black100"}},children:[r("title-sign-in-1")," ",t.jsx(S,{to:W.fullPath,sx:{default:{variant:"h8",weight:400,color:"blueRest"}},children:r("title-sign-in-2")})]})]}):t.jsx(s.Field,{name:"email",children:e=>t.jsxs(i,{sx:{default:{flexDirection:"column",gap:"6px",position:"relative"}},children:[t.jsx(u,{sx:{default:{variant:"h2",weight:700,color:"black100"}},children:r("title-confirmation")}),t.jsxs(u,{sx:{default:{variant:"h8",weight:400,color:"black100"}},children:[r("title-confirmation-description")," ",t.jsx(u,{sx:{default:{variant:"h8",weight:400,color:"blueRest",cursor:"pointer"}},children:e.state.value}),"."]})]})})}),t.jsxs(O,{sx:{default:{width:"100%",gap:"25px"}},handleSubmit:s.handleSubmit,children:[n!==0?t.jsx(s.Field,{name:"code",children:e=>t.jsx(i,{sx:{default:{flexDirection:"column",gap:"6px",position:"relative",alignItems:"center"}},children:t.jsx(N,{id:e.name,sx:{default:{width:"360px"}},length:5,onBlur:e.handleBlur,onChange:e.handleChange,genre:"grayBorder",size:"large",error:o(e.state.meta)})})}):t.jsxs(t.Fragment,{children:[t.jsx(s.Field,{name:"email",children:e=>t.jsx(i,{sx:{default:{flexDirection:"column",gap:"6px",position:"relative"}},children:t.jsx(g,{variety:"standard",autoComplete:"email",placeholder:d("email.placeholder"),type:"email",id:e.name,name:e.name,value:e.state.value,onBlur:e.handleBlur,onChange:e.handleChange,genre:"grayBorder",size:"medium",isNoSpaces:!0,error:o(e.state.meta)})})}),t.jsx(s.Field,{name:"username",children:e=>t.jsx(i,{sx:{default:{flexDirection:"column",gap:"6px",position:"relative"}},children:t.jsx(g,{variety:"standard",autoComplete:"username",placeholder:d("username.placeholder"),type:"username",id:e.name,name:e.name,value:e.state.value,onBlur:e.handleBlur,onChange:e.handleChange,genre:"grayBorder",size:"medium",isNoSpaces:!0,error:o(e.state.meta)})})}),t.jsx(s.Field,{name:"dateOfBirth",children:e=>{const f=w.utc().subtract(118,"years").valueOf(),l=w.utc().subtract(18,"years").valueOf();return t.jsx(i,{sx:{default:{flexDirection:"column",gap:"6px",position:"relative"}},children:t.jsx(V,{locale:{months:Object.values(p("months",{returnObjects:!0})),weeks:Object.values(p("weeks",{returnObjects:!0})),inputs:p("input",{returnObjects:!0})},notValidDate:{errorMessage:p("not-valid-date"),isErrorAbsolute:!0},labelPlaceholder:d("dateOfBirth.placeholder"),id:e.name,name:e.name,isOnClickClose:!0,value:e.state.value,onBlur:e.handleBlur,onChange:e.handleChange,genre:"grayBorder",dateMin:f,dateMax:l,dateDefault:l,size:"medium",error:o(e.state.meta)})})}}),t.jsx(s.Field,{name:"currentPassword",children:e=>t.jsx(i,{sx:{default:{flexDirection:"column",gap:"6px",position:"relative"}},children:t.jsx(g,{variety:"standard",autoComplete:"current-password",type:"password",placeholder:d("password.placeholder"),id:e.name,name:e.name,value:e.state.value,onBlur:e.handleBlur,onChange:e.handleChange,genre:"grayBorder",size:"medium",isNoSpaces:!0,error:o(e.state.meta)})})}),t.jsx(s.Field,{name:"confirmPassword",children:e=>t.jsx(i,{sx:{default:{flexDirection:"column",gap:"6px",position:"relative"}},children:t.jsx(g,{variety:"standard",autoComplete:"current-password",type:"password",placeholder:d("password.placeholder-confirm"),id:e.name,name:e.name,value:e.state.value,onBlur:e.handleBlur,onChange:e.handleChange,genre:"grayBorder",size:"medium",isNoSpaces:!0,error:o(e.state.meta)})})})]}),t.jsx(s.Field,{name:"email",children:e=>n!==0&&n<3&&!e.state.meta.errors.length&&t.jsxs(i,{sx:{default:{alignItems:"center",justifyContent:"space-between",flexDirection:"row"}},children:[P>0&&t.jsx(u,{sx:{default:{variant:"h7",weight:400,color:"black100"}},children:r("title-repeat",{seconds:P})}),t.jsx(C,{type:"button",genre:"blackBorder",isOnlyIcon:D,icons:[{type:"loading",name:"Line",isHidden:!D}],sx:{default:{marginLeft:"auto"}},isDisabled:B,isHidden:B,size:"medium",onClick:()=>{H(e.state.value)},children:r("title-button-repeat")})]})}),t.jsx(s.Subscribe,{children:e=>t.jsx(C,{type:"submit",isHidden:!e.canSubmit,isDisabled:!e.canSubmit||e.isSubmitting,genre:"product",size:"medium",isOnlyIcon:e.isSubmitting,icons:[{type:"loading",name:"Line",isHidden:!e.isSubmitting}],children:r(n!==0?"title-button-continue":"title-button")})}),n!==0&&t.jsx(u,{sx:{default:{variant:"h7",weight:400,color:"black100"}},children:r("title-spam")})]})]})}export{Q as P,X as a,Z as b};
